# 目录冲突解决方案

## 问题描述

当您尝试在已经存在的目录中克隆Git仓库时，会出现以下错误：
```fatal: destination path '.' already exists and is not an empty directory.
```

## 解决方案

### 方案一：使用初始化脚本（推荐）

1. 下载初始化脚本到服务器：
```bash
# 创建临时目录
mkdir -p /tmp/beautyclub-setup
cd /tmp/beautyclub-setup

# 下载初始化脚本
wget https://raw.githubusercontent.com/your-username/BeautyClub/main/scripts/setup-project.sh
chmod +x setup-project.sh

# 运行初始化脚本
./setup-project.sh
```

2. 脚本会自动处理目录冲突问题

### 方案二：手动解决

#### 步骤1：备份现有文件（如果需要）
```bash
# 进入项目目录
cd /www/wwwroot/beautyclub

# 备份现有文件
tar -czf backup-$(date +%Y%m%d_%H%M%S).tar.gz ./*
```

#### 步骤2：清空目录
```bash
# 删除所有文件（谨慎操作）
rm -rf ./*
rm -rf ./.* 2>/dev/null || true
```

#### 步骤3：重新克隆
```bash
# 克隆项目
git clone https://gitee.com/your-username/BeautyClub.git .

# 设置权限
chmod +x scripts/*.sh
```

### 方案三：使用不同的目录名

```bash
# 创建新的目录名
mkdir -p /www/wwwroot/beautyclub-new
cd /www/wwwroot/beautyclub-new

# 克隆项目
git clone https://gitee.com/your-username/BeautyClub.git .

# 设置权限
chmod +x scripts/*.sh

# 如果需要，可以重命名目录
cd ..
mv beautyclub beautyclub-old
mv beautyclub-new beautyclub
```

### 方案四：使用Git Pull（如果目录已经是Git仓库）

```bash
# 进入项目目录
cd /www/wwwroot/beautyclub

# 检查是否是Git仓库
if [ -d ".git" ]; then
    echo "目录已经是Git仓库，使用git pull更新"
    git pull origin main
else
    echo "目录不是Git仓库，需要重新克隆"
    # 执行方案二或方案三
fi
```

## 验证解决方案

克隆完成后，验证项目是否正确：

```bash
# 检查文件是否存在
ls -la

# 检查关键文件
ls -la Dockerfile docker-compose.yml scripts/

# 检查Git状态
git status
```

## 常见问题

### Q1: 如何确认目录是否为空？
```bash
ls -la
```
如果只显示 `.` 和 `..`，则目录为空。

### Q2: 如何安全地清空目录？
```bash
# 先查看目录内容
ls -la

# 确认无误后清空
rm -rf ./*
rm -rf ./.* 2>/dev/null || true
```

### Q3: 如何备份重要文件？
```bash
# 创建备份
tar -czf backup-$(date +%Y%m%d_%H%M%S).tar.gz ./*

# 或者复制到其他位置
cp -r /www/wwwroot/beautyclub /www/backup/beautyclub-backup
```

### Q4: 克隆失败怎么办？
```bash
# 检查网络连接
ping gitee.com

# 检查Git配置
git config --list

# 尝试使用HTTPS
git clone https://gitee.com/your-username/BeautyClub.git .

# 或者使用SSH（需要配置SSH密钥）
git clone git@gitee.com:your-username/BeautyClub.git .
```

## 预防措施

1. **使用初始化脚本**：避免手动操作错误
2. **定期备份**：重要文件定期备份
3. **使用版本控制**：所有配置变更都提交到Git
4. **测试环境**：先在测试环境验证部署流程

## 下一步操作

解决目录冲突后，继续执行部署：

```bash
# 进入项目目录
cd /www/wwwroot/beautyclub

# 运行部署脚本
./scripts/bt-deploy.sh

# 或者使用Docker Compose
docker-compose up -d --build
```

## 联系支持

如果遇到其他问题，请：
1. 查看详细日志
2. 检查网络连接
3. 确认Git仓库地址正确
4. 参考完整部署文档 