# BeautyClub æ‰‹åŠ¨éƒ¨ç½²æŒ‡å—

## ğŸ¯ æ¦‚è¿°

æœ¬æŒ‡å—ä»‹ç»å¦‚ä½•åœ¨å®å¡”æœåŠ¡å™¨ä¸Šæ‰‹åŠ¨éƒ¨ç½²BeautyClubé¡¹ç›®ï¼Œæ”¯æŒæŒ‡å®šä¸åŒçš„ä»£ç åˆ†æ”¯ã€‚

## ğŸ“‹ å‰ç½®è¦æ±‚

### å®å¡”æœåŠ¡å™¨ç¯å¢ƒ
- æ“ä½œç³»ç»Ÿï¼šCentOS 7+ / Ubuntu 18+ / Debian 9+
- å†…å­˜ï¼šè‡³å°‘2GB
- ç£ç›˜ï¼šè‡³å°‘20GBå¯ç”¨ç©ºé—´
- å®å¡”é¢æ¿ï¼š7.0+

### å¿…éœ€è½¯ä»¶
- Docker 20.10+
- Docker Compose 2.0+
- Git

## ğŸ§¹ å½»åº•æ¸…ç†å¹¶é‡æ–°éƒ¨ç½²

å¦‚æœéœ€è¦å½»åº•æ¸…ç†æ‰€æœ‰å®¹å™¨ã€ç½‘ç»œã€å·å’Œç¼“å­˜ï¼Œé‡æ–°éƒ¨ç½²é¡¹ç›®ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

```bash
cd /www/wwwroot/beautyclub

# åœæ­¢å¹¶åˆ é™¤æ‰€æœ‰å®¹å™¨
docker-compose down -v

# åˆ é™¤æœªä½¿ç”¨çš„é•œåƒã€å®¹å™¨ã€ç½‘ç»œã€å·
# æ³¨æ„ï¼šæ­¤æ“ä½œä¼šæ¸…ç†æ‰€æœ‰æœªè¢«ä½¿ç”¨çš„dockerèµ„æºï¼Œè¯·è°¨æ…ï¼
docker system prune -af
# å¦‚éœ€è¿å·ä¸€èµ·æ¸…ç†ï¼š
docker volume prune -f
# å¦‚éœ€è¿ç½‘ç»œä¸€èµ·æ¸…ç†ï¼š
docker network prune -f

# æ£€æŸ¥æ˜¯å¦è¿˜æœ‰æ®‹ç•™å®¹å™¨ã€å·ã€ç½‘ç»œ
# æŸ¥çœ‹æ‰€æœ‰å®¹å™¨
docker ps -a
# æŸ¥çœ‹æ‰€æœ‰å·
docker volume ls
# æŸ¥çœ‹æ‰€æœ‰ç½‘ç»œ
docker network ls

# é‡æ–°æ„å»ºå¹¶å¯åŠ¨æœåŠ¡
./scripts/update-and-deploy.sh
```

---

## ğŸš€ æ—¥å¸¸æ‹‰å–ä»£ç å¹¶å‘å¸ƒï¼ˆsg-devåˆ†æ”¯ï¼‰

æ¯æ¬¡éœ€è¦æ›´æ–°å¹¶å‘å¸ƒæœ€æ–°ä»£ç æ—¶ï¼Œç›´æ¥æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

```bash
cd /www/wwwroot/beautyclub

git fetch origin
# åˆ‡æ¢åˆ°sg-devåˆ†æ”¯ï¼ˆå¦‚å·²åœ¨sg-devå¯çœç•¥ï¼‰
git checkout sg-dev
git pull origin sg-dev

docker-compose down
docker-compose build --no-cache beautyclub
docker-compose up -d
docker-compose logs beautyclub
```

---

## ğŸ”„ æ—¥å¸¸æ‹‰å–ä»£ç å¹¶å‘å¸ƒï¼ˆsg-devåˆ†æ”¯ï¼‰

æ¯æ¬¡éœ€è¦æ›´æ–°å¹¶å‘å¸ƒæœ€æ–°ä»£ç æ—¶ï¼Œç›´æ¥æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

```bash
cd /www/wwwroot/beautyclub

git fetch origin
# åˆ‡æ¢åˆ°sg-devåˆ†æ”¯ï¼ˆå¦‚å·²åœ¨sg-devå¯çœç•¥ï¼‰
git checkout sg-dev
git pull origin sg-dev

docker-compose down
docker-compose build --no-cache beautyclub
docker-compose up -d
```

> å¯é€‰ï¼šæŸ¥çœ‹æœåŠ¡çŠ¶æ€å’Œæ—¥å¿—
```bash
docker-compose ps
docker-compose logs beautyclub
```

---

### 2. é¦–æ¬¡éƒ¨ç½²

#### 2.1 ä¸‹è½½éƒ¨ç½²è„šæœ¬
```bash
# åˆ›å»ºä¸´æ—¶ç›®å½•
mkdir -p /tmp/beautyclub-deploy
cd /tmp/beautyclub-deploy

# ä¸‹è½½éƒ¨ç½²è„šæœ¬ï¼ˆéœ€è¦å…ˆä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼‰
# æˆ–è€…ç›´æ¥ä»Gitä»“åº“å…‹éš†
git clone https://gitee.com/why110/BeautyClub.git temp-clone
cp temp-clone/scripts/manual-deploy.sh /www/wwwroot/beautyclub/
chmod +x /www/wwwroot/beautyclub/manual-deploy.sh
rm -rf temp-clone
```

#### 2.2 æ‰§è¡Œéƒ¨ç½²
```bash
cd /www/wwwroot/beautyclub

# éƒ¨ç½²sg-devåˆ†æ”¯
./manual-deploy.sh -b sg-dev

# å¼ºåˆ¶é‡æ–°éƒ¨ç½²ï¼ˆä¼šæ¸…ç©ºç°æœ‰ç›®å½•ï¼‰
./manual-deploy.sh -b sg-dev -f
```

### 3. éªŒè¯éƒ¨ç½²

#### 3.1 æ£€æŸ¥æœåŠ¡çŠ¶æ€
```bash
cd /www/wwwroot/beautyclub
docker-compose ps
```

#### 3.2 æ£€æŸ¥åº”ç”¨å¥åº·çŠ¶æ€
```bash
curl http://localhost/health
```

#### 3.3 è®¿é—®åº”ç”¨
- å‰ç«¯åœ°å€ï¼šhttp://your-server-ip
- APIåœ°å€ï¼šhttp://your-server-ip/api
- ç®¡ç†åå°ï¼šhttp://your-server-ip/login

## ğŸ”§ å¸¸ç”¨æ“ä½œ

### æŸ¥çœ‹å¸®åŠ©
```bash
./manual-deploy.sh -h
```

### éƒ¨ç½²ä¸åŒåˆ†æ”¯
```bash
# éƒ¨ç½²sg-devåˆ†æ”¯
./manual-deploy.sh -b sg-dev
```

### å¼ºåˆ¶é‡æ–°éƒ¨ç½²
```bash
# å¼ºåˆ¶é‡æ–°éƒ¨ç½²ï¼ˆä¼šæ¸…ç©ºç°æœ‰ç›®å½•å’Œä»£ç ï¼‰
./manual-deploy.sh -b sg-dev -f
```

### æŸ¥çœ‹æœåŠ¡æ—¥å¿—
```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
docker-compose logs beautyclub

# æŸ¥çœ‹æ•°æ®åº“æ—¥å¿—
docker-compose logs mysql

# æŸ¥çœ‹Redisæ—¥å¿—
docker-compose logs redis

# æŸ¥çœ‹Nginxæ—¥å¿—
docker-compose logs nginx
```

### æœåŠ¡ç®¡ç†
```bash
# é‡å¯æœåŠ¡
docker-compose restart

# åœæ­¢æœåŠ¡
docker-compose down

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# é‡æ–°æ„å»ºå¹¶å¯åŠ¨
docker-compose up -d --build
```

## ğŸ“ é¡¹ç›®ç»“æ„

éƒ¨ç½²å®Œæˆåï¼Œé¡¹ç›®ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š
```
/www/wwwroot/beautyclub/
â”œâ”€â”€ Dockerfile                 # Dockeré•œåƒæ„å»ºæ–‡ä»¶
â”œâ”€â”€ docker-compose.yml         # æœåŠ¡ç¼–æ’æ–‡ä»¶
â”œâ”€â”€ manual-deploy.sh           # æ‰‹åŠ¨éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ scripts/                   # å…¶ä»–è„šæœ¬
â”œâ”€â”€ nginx/                     # Nginxé…ç½®
â”œâ”€â”€ ruoyi-admin/              # åº”ç”¨ä»£ç 
â”œâ”€â”€ ruoyi-common/             # å…¬å…±æ¨¡å—
â”œâ”€â”€ ruoyi-framework/          # æ¡†æ¶æ¨¡å—
â”œâ”€â”€ ruoyi-system/             # ç³»ç»Ÿæ¨¡å—
â””â”€â”€ .git/                     # Gitä»“åº“
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. éƒ¨ç½²è„šæœ¬æƒé™é—®é¢˜
```bash
chmod +x manual-deploy.sh
```

#### 2. DockeræœåŠ¡æœªå¯åŠ¨
```bash
# åœ¨å®å¡”é¢æ¿ä¸­å¯åŠ¨Dockerç®¡ç†å™¨
# æˆ–è€…å‘½ä»¤è¡Œå¯åŠ¨
systemctl start docker
```

#### 3. ç«¯å£è¢«å ç”¨
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tlnp | grep :80
netstat -tlnp | grep :8080

# åœæ­¢å ç”¨ç«¯å£çš„æœåŠ¡
docker-compose down
```

#### 4. å†…å­˜ä¸è¶³
```bash
# æ£€æŸ¥å†…å­˜ä½¿ç”¨
free -h

# æ¸…ç†Dockerèµ„æº
docker system prune -f
```

#### 5. ç£ç›˜ç©ºé—´ä¸è¶³
```bash
# æ£€æŸ¥ç£ç›˜ä½¿ç”¨
df -h

# æ¸…ç†Dockeré•œåƒ
docker image prune -f
```

### æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
```bash
# æŸ¥çœ‹éƒ¨ç½²è„šæœ¬æ—¥å¿—
./manual-deploy.sh 2>&1 | tee deploy.log

# æŸ¥çœ‹Docker Composeæ—¥å¿—
docker-compose logs --tail=100
```

## ğŸ”„ æ›´æ–°éƒ¨ç½²

### æ›´æ–°åˆ°æœ€æ–°ä»£ç 
```bash
# æ›´æ–°åˆ°sg-devåˆ†æ”¯æœ€æ–°ä»£ç 
./manual-deploy.sh -b sg-dev
```

### å›æ»šåˆ°ä¹‹å‰çš„ç‰ˆæœ¬
```bash
# æŸ¥çœ‹æäº¤å†å²
git log --oneline -10

# åˆ‡æ¢åˆ°ç‰¹å®šæäº¤
git checkout <commit-hash>
docker-compose up -d --build
```

## ğŸ“Š ç›‘æ§å’Œç»´æŠ¤

### å¥åº·æ£€æŸ¥
```bash
# æ£€æŸ¥åº”ç”¨å¥åº·çŠ¶æ€
curl http://localhost/health

# æ£€æŸ¥æ•°æ®åº“è¿æ¥
docker exec beautyclub-mysql mysqladmin ping -h localhost -u beautyclub -pbeautyclub123
```

### æ•°æ®å¤‡ä»½
```bash
# å¤‡ä»½æ•°æ®åº“
docker exec beautyclub-mysql mysqldump -u beautyclub -pbeautyclub123 beautyclub > backup.sql

# å¤‡ä»½ä¸Šä¼ æ–‡ä»¶
docker run --rm -v beautyclub_upload_path:/data -v $(pwd):/backup alpine tar czf /backup/upload_files.tar.gz -C /data .
```

### æ€§èƒ½ç›‘æ§
```bash
# æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨
docker stats

# æŸ¥çœ‹ç³»ç»Ÿèµ„æº
htop
```

## ğŸ‰ éƒ¨ç½²å®Œæˆ

éƒ¨ç½²æˆåŠŸåï¼Œæ‚¨å°†çœ‹åˆ°ï¼š
- âœ… æ‰€æœ‰æœåŠ¡æ­£å¸¸è¿è¡Œ
- âœ… åº”ç”¨å¯ä»¥æ­£å¸¸è®¿é—®
- âœ… æ•°æ®åº“è¿æ¥æ­£å¸¸
- âœ… æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ­£å¸¸

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹éƒ¨ç½²æ—¥å¿—
2. æ£€æŸ¥æœåŠ¡çŠ¶æ€
3. ç¡®è®¤ç¯å¢ƒé…ç½®
4. å‚è€ƒæ•…éšœæ’é™¤éƒ¨åˆ†

---

**æ‰‹åŠ¨éƒ¨ç½²å®Œæˆï¼** ğŸ‰ 